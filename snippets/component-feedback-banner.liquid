{% comment %}
  Banner Component
  Highlights important information or required actions prominently within the interface.
  
  @param {string} title - Banner title (optional)
  @param {string} text - Banner text/content (required)
  @param {string} variant - Banner style: info, success, warning, error (default: info)
  @param {string} icon - Icon name (Lucide icon) (optional)
  @param {boolean} dismissible - Show dismiss button (default: false)
  @param {string} class - Additional CSS classes
  @param {string} attributes - Additional HTML attributes
  
  @example
  {% render 'component-feedback-banner', text: 'Important notice', variant: 'warning', dismissible: true %}
{% endcomment %}

{% liquid
  assign title = title | default: ''
  assign text = text | default: ''
  assign variant = variant | default: 'info'
  assign icon = icon | default: ''
  assign dismissible = dismissible | default: false
  assign class = class | default: ''
  assign attributes = attributes | default: ''
  
  unless text != blank
    echo '<!-- Error: text parameter required for banner component -->'
    break
  endunless
  
  if icon == blank
    case variant
      when 'success'
        assign icon = 'check-circle'
      when 'warning'
        assign icon = 'alert-triangle'
      when 'error'
        assign icon = 'x-circle'
      else
        assign icon = 'info'
    endcase
  endif
  
  assign banner_id = 'banner-' | append: variant | append: '-' | append: 'now' | date: '%s'
%}

<div 
  class="ds-banner ds-banner--{{ variant }} {{ class }}"
  id="{{ banner_id }}"
  role="alert"
  {{ attributes }}
>
  <div class="ds-banner__content">
    {% if icon != blank %}
      <i data-lucide="{{ icon }}" class="ds-banner__icon"></i>
    {% endif %}
    <div class="ds-banner__text">
      {% if title != blank %}
        <div class="ds-banner__title">{{ title }}</div>
      {% endif %}
      <div class="ds-banner__message">{{ text }}</div>
    </div>
  </div>
  {% if dismissible %}
    <button 
      type="button"
      class="ds-banner__dismiss"
      aria-label="Dismiss banner"
      data-banner-dismiss
    >
      <i data-lucide="x" class="ds-banner__dismiss-icon"></i>
    </button>
  {% endif %}
</div>

{% stylesheet %}
  .ds-banner {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: var(--spacing-md);
    padding: var(--spacing-md);
    border-radius: var(--card-border-radius);
    border-width: 1px;
    border-style: solid;
  }
  
  .ds-banner--info {
    background-color: color-mix(in srgb, var(--color-primary) 10%, transparent);
    border-color: var(--color-primary);
    color: var(--color-primary);
  }
  
  .ds-banner--success {
    background-color: color-mix(in srgb, var(--color-success) 10%, transparent);
    border-color: var(--color-success);
    color: var(--color-success);
  }
  
  .ds-banner--warning {
    background-color: color-mix(in srgb, var(--color-warning) 10%, transparent);
    border-color: var(--color-warning);
    color: var(--color-warning);
  }
  
  .ds-banner--error {
    background-color: color-mix(in srgb, var(--color-error) 10%, transparent);
    border-color: var(--color-error);
    color: var(--color-error);
  }
  
  .ds-banner__content {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    flex: 1;
  }
  
  .ds-banner__icon {
    width: 1.5rem;
    height: 1.5rem;
    flex-shrink: 0;
    margin-top: 0.125rem;
  }
  
  .ds-banner__text {
    flex: 1;
  }
  
  .ds-banner__title {
    font-size: var(--font-size-base);
    font-weight: calc(var(--font-primary--weight) + 200);
    margin-bottom: var(--spacing-xs);
  }
  
  .ds-banner__message {
    font-size: var(--font-size-base);
    line-height: var(--line-height-body);
  }
  
  .ds-banner__dismiss {
    background: none;
    border: none;
    padding: 0.25rem;
    cursor: pointer;
    color: currentColor;
    opacity: 0.7;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  
  .ds-banner__dismiss:hover {
    opacity: 1;
  }
  
  .ds-banner__dismiss-icon {
    width: 1.25rem;
    height: 1.25rem;
  }
{% endstylesheet %}

{% javascript %}
  (function() {
    const dismissButtons = document.querySelectorAll('[data-banner-dismiss]');
    
    dismissButtons.forEach(button => {
      button.addEventListener('click', function() {
        const banner = this.closest('.ds-banner');
        if (banner) {
          banner.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
          banner.style.opacity = '0';
          banner.style.transform = 'translateY(-10px)';
          setTimeout(() => {
            banner.remove();
          }, 300);
        }
      });
    });
    
    if (typeof lucide !== 'undefined') {
      lucide.createIcons();
    }
  })();
{% endjavascript %}

