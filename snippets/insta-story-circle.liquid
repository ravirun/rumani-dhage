{% comment %}
  Story Trigger Bubble
  Expects:
  - block: the story block
{% endcomment %}

{% liquid
  assign product = block.settings.product
  assign image = block.settings.image
  if image == blank and product != blank
    assign image = product.featured_media
  endif
%}

<div
  class="instagram-story__item"
  data-product-handle="{{ product.handle }}"
  data-image="{% if block.settings.story_image != blank %}{{ block.settings.story_image | image_url: width: 1200 }}{% elsif image != blank %}{{ image | image_url: width: 1200 }}{% endif %}"
  data-video="{{ block.settings.video.id | default: '' }}"
  data-title="{{ product.title | default: block.settings.label }}"
  data-price="{{ product.price | money }}"
  data-fabric="{{ block.settings.fabric | escape }}"
  data-story-index="{{ forloop.index0 }}"
  data-open-story
>
  <div class="insta-story-outer-circle">
    <div class="insta-story-inner-circle">
      {% if image != blank %}
        <img
          src="{{ image | image_url: width: 200, height: 200, crop: 'center' }}"
          alt="{{ product.title | escape }}"
          width="100"
          height="100"
          loading="lazy"
        >
      {% else %}
        {{ 'product-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
      {% endif %}
    </div>
  </div>

  <h3 class="instagram-story__label">
    {{ block.settings.label }}
  </h3>
</div>
