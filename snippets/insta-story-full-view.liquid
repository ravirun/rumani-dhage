{% comment %}
  Full-screen Instagram Story Viewer Modal
  Expects:
  - blocks: section blocks
{% endcomment %}

{% liquid

%}

<modal-dialog id="InstaStoryModal" class="insta-story-full-view-modal">
  <div
    role="dialog"
    aria-label="Instagram Story"
    aria-modal="true"
    class="insta-story-full-view"
    tabindex="-1"
  >
    {% comment %} Top Progress Bars {% endcomment %}
    <div class="insta-story-full-view__progress-container">
      {% for block in blocks %}
        <div class="insta-story-full-view__progress-segment" data-segment-index="{{ forloop.index0 }}">
          <div class="insta-story-full-view__progress-fill"></div>
        </div>
      {% endfor %}
    </div>

    {% comment %} Top Bar (User Info & Close) {% endcomment %}
    <div class="insta-story-full-view__top-bar">
      <div class="insta-story-full-view__user-info">
        <span class="insta-story-full-view__user-title" data-story-title></span>
        <span class="insta-story-full-view__time">JUST NOW</span>
      </div>
      <button
        id="ModalClose-InstaStoryModal"
        type="button"
        class="insta-story-full-view__close-btn"
        aria-label="{{ 'accessibility.close' | t }}"
        data-close-modal
      >
        {% render 'icon-close' %}
      </button>
    </div>

    <div class="insta-story-full-view__content-wrapper">
      {% comment %} Side navigation (Desktop) {% endcomment %}
      <button
        type="button"
        class="insta-story-full-view__nav-side insta-story-full-view__nav-side--prev"
        data-story-prev
        aria-label="{{ 'general.pagination.previous' | t }}"
      >
        <span class="icon-arrow-left">{% render 'icon-arrow' %}</span>
      </button>

      {% comment %} Main Media and Product Overlay Container {% endcomment %}
      <div class="insta-story-full-view__media-container">
        <div class="insta-story-full-view__media">
          {% comment %} Content dynamically injected via JS {% endcomment %}
        </div>

        {% comment %} LUXURY QUICK BUY PANEL {% endcomment %}
        <div class="insta-story-full-view__quick-buy-panel" data-quick-buy-panel>
          <div class="quick-buy-panel__header">
            <h3 class="quick-buy-panel__title serif" data-pb-title>Product Name</h3>
            <span class="quick-buy-panel__price" data-pb-price>â‚¹0.00</span>
          </div>

          <div class="quick-buy-panel__highlights" data-pb-fabric>
            {% comment %} Fabric/Highlights content {% endcomment %}
          </div>

          <div class="quick-buy-panel__actions">
            <button type="button" class="button button--primary quick-buy-panel__atc-btn" data-pb-atc>
              <span>Add to Bag</span>
              <div class="loading-overlay__spinner hidden">
                <svg
                  aria-hidden="true"
                  focusable="false"
                  class="spinner"
                  viewBox="0 0 66 66"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                </svg>
              </div>
            </button>
            <a href="#" class="quick-buy-panel__details-link" data-pb-details-link> View Details &rarr; </a>
          </div>
        </div>

        {% comment %} Mobile Mini Trigger (to open Quick Buy panel) {% endcomment %}
        <div class="insta-story-full-view__mobile-trigger">
          <button type="button" class="insta-story-full-view__shop-btn" data-toggle-quick-buy>Shop Now</button>
        </div>
      </div>

      <button
        type="button"
        class="insta-story-full-view__nav-side insta-story-full-view__nav-side--next"
        data-story-next
        aria-label="{{ 'general.pagination.next' | t }}"
      >
        <span class="icon-arrow-right">{% render 'icon-arrow' %}</span>
      </button>
    </div>

    {% comment %} Bottom Bar {% endcomment %}
    <div class="insta-story-full-view__bottom-bar">
      <div class="insta-story-full-view__views">
        <span>&copy; Rumani Dhage</span>
      </div>
      <div class="insta-story-full-view__next-label" data-story-next>
        <span class="icon-play">{% render 'icon-play' %}</span>
        <span>NEXT</span>
      </div>
    </div>
  </div>
</modal-dialog>
